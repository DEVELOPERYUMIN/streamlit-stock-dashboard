# pages/2_차트읽는법.py
import streamlit as st

st.set_page_config(page_title="차트 읽는 법", layout="wide")

st.title("차트 읽는 법")

st.markdown(
"""
이 페이지는 메인 차트(종가/이동평균/거래량/MDD 강조/hover 통합/애니메이션)를 읽는 순서를 정리한다.
"""
)

st.subheader("1) 차트를 볼 때 먼저 확인할 것")
st.markdown(
"""
- 선택한 기간이 언제부터 언제까지인지 확인한다. 해석은 기간에 따라 달라진다.
- 차트에 표시된 지표가 무엇인지 확인한다(종가/MA20/MA60/거래량).
- 요약 카드에서 기간 수익률과 MDD를 먼저 본다.
  - 수익률: 끝값 기준 결과
  - MDD: 기간 중 최악의 하락 폭(리스크)
"""
)

st.subheader("2) 종가(Close) 라인 읽기")
st.markdown(
"""
- 종가 라인은 가격의 시간 흐름을 직접 보여준다.
- 급격한 하락/상승 구간이 있는지 먼저 찾는다.
- 고점과 저점이 어디인지 확인한 뒤, MDD 표시가 어디에 찍혔는지 연결해서 본다.
"""
)

st.subheader("3) 이동평균선(MA20/MA60) 읽기")
st.markdown(
"""
- 이동평균선은 가격을 평균으로 평활화해서 추세를 보기 쉽게 만든다.
- MA20은 단기(상대적으로 민감), MA60은 중기(상대적으로 둔감)로 해석한다.
- 가격이 MA 위에 오래 머물면 강한 흐름으로 해석하는 방식이 많지만, 단독으로 확정 신호로 쓰기 어렵다.
- 기간이 짧으면 MA가 NaN이 되어 표시 자체가 꺼질 수 있다(계산 불가 구간).
"""
)

st.subheader("4) 거래량(Volume) 막대 읽기")
st.markdown(
"""
- 거래량은 보조축(y2)을 사용한다. 가격축과 단위/스케일이 달라서 같은 축으로 비교하면 왜곡된다.
- 특정 날짜에 거래량이 급증했는지 확인하고, 같은 날 가격이 어떻게 움직였는지 함께 본다.
- 거래량은 “설명 변수”가 아니라 “상황 지표”로 보는 편이 안전하다.
"""
)

st.subheader("5) Hover(툴팁) 활용")
st.markdown(
"""
- 차트 hovermode가 x unified로 설정되어 같은 날짜의 값이 한 곳에 묶여 나온다.
- 종가 트레이스의 hovertemplate에 MA/거래량을 customdata로 함께 넣어서 한 번에 표시한다.
- 날짜별로 종가/MA/거래량을 정확한 숫자로 확인할 때 사용한다.
"""
)

st.subheader("6) MDD(최대낙폭) 강조 구간 읽기")
st.markdown(
"""
- 음영 구간은 최대낙폭이 발생한 고점(peak)에서 저점(trough)까지의 구간이다.
- Peak 마커: 저점 이전 구간에서의 최고 종가
- Trough 마커: 드로우다운이 최소가 되는 최저 종가
- 해석 포인트:
  - 음영 폭이 넓을수록(기간이 길수록) 회복에 시간이 걸렸을 가능성이 있다.
  - 음영 폭이 짧고 낙폭이 크면 단기간 변동 리스크가 컸던 구간으로 볼 수 있다.
- MDD는 기간을 바꾸면 값과 구간이 바뀐다. 동일 종목도 조회 기간에 따라 리스크 해석이 달라진다.
"""
)

st.subheader("7) Close 타임-플레이 애니메이션 해석")
st.markdown(
"""
- 애니메이션은 종가 라인을 “시간 순서대로 점진적으로 그리기” 위한 시각 효과다.
- 분석 지표를 바꾸진 않는다. 흐름(추세/변곡 구간)을 눈으로 따라가기 쉽게 만드는 목적이다.
- 성능을 위해 최근 약 1년(최대 260 프레임)으로 제한한다.
"""
)

st.subheader("8) 자주 생기는 오해")
with st.expander("수익률이 플러스면 리스크가 낮은가"):
    st.markdown(
    """
    - 아니다. 기간 수익률은 끝값만 본다.
    - 기간 중 큰 하락이 있었는지는 MDD로 확인한다.
    """
    )
with st.expander("MA 교차만으로 매매 판단이 가능한가"):
    st.markdown(
    """
    - MA는 추세를 단순화한 지표다.
    - 교차는 참고 신호일 뿐이며, 기간/종목 특성에 따라 의미가 달라질 수 있다.
    """
    )
with st.expander("거래량이 증가하면 무조건 상승하는가"):
    st.markdown(
    """
    - 아니다. 거래량은 변동이 커지는 국면에서도 증가할 수 있다.
    - 같은 날 가격 움직임과 같이 해석한다.
    """
    )
