# pages/2_차트읽는법.py
import streamlit as st

st.set_page_config(page_title="차트 읽는 법", layout="wide")

st.title("📚 차트 읽는 법")
st.markdown(
    """
이 페이지는 메인 차트(종가/이동평균/거래량/MDD 강조/hover 통합/애니메이션)를 **어떤 순서로 읽으면 좋은지** 정리합니다.
"""
)

st.subheader("1) 차트를 볼 때 먼저 확인할 것")
st.markdown(
    """
- 조회한 **기간(시작일–종료일)** 을 먼저 확인합니다. 해석은 기간에 따라 달라집니다.
- 차트에 **어떤 지표가 켜져 있는지** 확인합니다(종가/MA20/MA60/거래량/MDD).
- 요약 카드에서 **기간 수익률**과 **MDD**를 먼저 봅니다.
  - **기간 수익률**: 기간 시작과 끝값만 반영한 결과
  - **MDD**: 기간 중 발생한 최악의 하락 폭(리스크)
"""
)

st.subheader("2) 종가(Close) 라인 읽기")
st.markdown(
    """
- 종가 라인은 가격의 **시간 흐름**을 직접 보여줍니다.
- 급격한 상승/하락 구간이 있는지 먼저 찾습니다.
- 고점과 저점이 어디인지 확인한 뒤, **MDD 강조 구간**이 어디에 찍혔는지 연결해서 봅니다.
"""
)

st.subheader("3) 이동평균선(MA20/MA60) 읽기")
st.markdown(
    """
- 이동평균선은 가격을 평균 내어 **추세를 단순화**한 지표입니다.
- **MA20**은 단기 흐름(상대적으로 민감), **MA60**은 중기 흐름(상대적으로 완만)으로 해석합니다.
- 가격이 MA 위/아래에 오래 머무는지는 **흐름 참고용**입니다. 확정 신호로 단독 사용하기는 어렵습니다.
- 조회 기간이 짧으면 MA가 계산되지 않아 표시가 꺼질 수 있습니다(계산 불가 구간).
"""
)

st.subheader("4) 거래량(Volume) 막대 읽기")
st.markdown(
    """
- 거래량은 **보조축(y2)** 을 사용합니다. 가격축과 단위가 다르므로 직접 비교하면 왜곡됩니다.
- 거래량이 급증한 날짜가 있는지 확인하고, **같은 날 가격 움직임과 함께** 봅니다.
- 거래량은 “원인”이라기보다 **관심도/변동성의 상황 지표**로 보는 편이 안전합니다.
"""
)

st.subheader("5) Hover(툴팁) 활용")
st.markdown(
    """
- hovermode가 `x unified`로 설정되어 **같은 날짜의 값이 한 곳에 묶여** 표시됩니다.
- 종가(그리고 필요 시 MA/거래량)를 **정확한 숫자로 확인**할 때 유용합니다.
- 날짜별로 세부 비교가 필요할 때 적극 활용합니다.
"""
)

st.subheader("6) MDD(최대낙폭) 강조 구간 읽기")
st.markdown(
    """
- 음영 구간은 **최대낙폭이 발생한 고점(peak) → 저점(trough)** 구간입니다.
- **Peak 마커**: 저점 이전 구간에서의 최고 종가  
- **Trough 마커**: 드로우다운이 최소가 되는 최저 종가  

**해석 포인트**
- 음영 구간이 길수록(기간이 길수록) 회복에 시간이 걸렸을 가능성이 있습니다.
- 음영 구간이 짧고 낙폭이 크면 단기 변동 리스크가 컸던 구간으로 볼 수 있습니다.
- MDD는 조회 기간을 바꾸면 값과 구간이 바뀝니다(기간 의존).
"""
)

st.subheader("7) Close 타임-플레이 애니메이션 해석")
st.markdown(
    """
- 애니메이션은 종가 라인을 **시간 순서대로 점진적으로 그리는 시각 효과**입니다.
- 분석 지표를 바꾸진 않습니다. 흐름(추세/변곡 구간)을 눈으로 따라가기 쉽게 만드는 목적입니다.
- 성능을 위해 최근 약 1년(최대 260 프레임)으로 제한할 수 있습니다.
"""
)

st.subheader("8) 자주 생기는 오해")
with st.expander("수익률이 플러스면 리스크가 낮은가?"):
    st.markdown(
        """
- 아닙니다. 기간 수익률은 **끝값만** 반영합니다.
- 기간 중 큰 하락이 있었는지는 **MDD로 확인**해야 합니다.
"""
    )

with st.expander("MA 교차만으로 매매 판단이 가능한가?"):
    st.markdown(
        """
- MA는 **추세를 단순화**한 지표입니다.
- 교차는 참고 신호일 뿐이며, 기간/종목 특성에 따라 의미가 달라질 수 있습니다.
"""
    )

with st.expander("거래량이 증가하면 무조건 상승하는가?"):
    st.markdown(
        """
- 아닙니다. 하락 국면에서도 거래량은 증가할 수 있습니다.
- 항상 **같은 날 가격 움직임과 함께** 해석하는 것이 안전합니다.
"""
    )

st.divider()
st.info(
    "요약: **수익률은 결과, MDD는 리스크, 이동평균은 흐름**입니다. "
    "차트는 하나의 신호가 아니라 여러 지표를 함께 읽어야 합니다."
)
